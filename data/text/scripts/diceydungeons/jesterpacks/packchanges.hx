trace(levelupselections);
for(x in ["Boosterpack:", "boosterpack:"]){  if (levelupselections.indexOf(x + "Shield Bash,Deflect,Deflect") > -1){     Rules.substitute("Backfire", "Iron Shield");     Rules.substitute("Bop,Bop,Bop", rand(["Sweets,Deflect,Sweets", "Sweets,Shield Bash,Deflect", "Deflect,Deflect,Deflect"]));   }     if (levelupselections.indexOf(x + "Ice Shatter,Snowflake,Snowflake") > -1){     Rules.substitute("Backfire", "Lament");     Rules.substitute("Bop,Bop,Bop", rand(["Snowflake,Buzzer,Snowflake", "Boop,Snowball,Boop", "Boop,Lament,Boop"]));   }    if (levelupselections.indexOf(x + "Detonator,Liquorice,Liquorice") > -1){     Rules.substitute("Backfire", "Claw");     Rules.substitute("Bop,Bop,Bop", rand(["Liquorice,Liquorice,Liquorice", "Liquorice,Claw,Sweets", "Sweets,Liquorice,Sweets"]));   }    if (levelupselections.indexOf(x + "High Voltage,Buzzer,Buzzer") > -1){     Rules.substitute("Backfire", "Hammer");     Rules.substitute("Bop,Bop,Bop", rand(["Buzzer,Hammer,Buzzer", "High Voltage,Spark,High Voltage"]));   }    if (levelupselections.indexOf(x + "Flame Blast,Spark,Spark") > -1){     Rules.substitute("Backfire", "Whip");     Rules.substitute("Bop,Bop,Bop", rand(["Spark,Spark,Spark", "Buzzer,Whip,Buzzer", "Snowflake,Spark,Snowflake"]));   }    if (levelupselections.indexOf(x + "Resonance,Whisper,Whisper") > -1){     Rules.substitute("Backfire", "Resonance");     Rules.substitute("Bop,Bop,Bop", rand(["Boop,Sonic Wave,Boop", "Boop,Resonance,Boop"]));   }    if (levelupselections.indexOf(x + "Hijinx,Slapsies,Slapsies") > -1){     Rules.substitute("Backfire", "Concentration");     Rules.substitute("Bop,Bop,Bop", rand(["Hijinx,Mercy,Concentration", "Slapsies,Lojinx,Slapsies"]));   }    if (levelupselections.indexOf(x + "Flying Skull,Evil Laugh,Evil Laugh") > -1){     Rules.substitute("Backfire", "Evil Laugh");     Rules.substitute("Bop,Bop,Bop", rand(["Evil Laugh,Evil Laugh,Evil Laugh", "Manic Laugh,Infestation,Manic Laugh"]));   }    if (levelupselections.indexOf(x + "Woof Woof Woof,Ruff Ruff Ruff,Ruff Ruff Ruff") > -1){     Rules.substitute("Backfire", "Yip Yip Yip");     Rules.substitute("Bop,Bop,Bop", rand(["Ruff Ruff Ruff,Arf Arf Arf,Ruff Ruff Ruff", "Ruff Ruff Ruff,Bow Wow Wow,Ruff Ruff Ruff"]));  }    if (levelupselections.indexOf(x + "Harmony,Melody,Melody") > -1){     Rules.substitute("Backfire", "Chorus");     Rules.substitute("Bop,Bop,Bop", rand(["Melody,Harmony,Melody", "Melody,Harmony,Melody"]));   }    if (levelupselections.indexOf(x + "Battering Ram,Front Line,Front Line") > -1){     Rules.substitute("Backfire", "Upkeep");     Rules.substitute("Bop,Bop,Bop", rand(["Front Line,Fortify,Front Line","Thick Skin,Fortify,Thick Skin"]));   }    if (levelupselections.indexOf(x + "Repeater,Laser,Laser") > -1) {    Rules.substitute("Backfire", "Stew");    Rules.substitute("Bop,Bop,Bop", rand(["Spike,Wind Up Fist,Spike", "Spike,Tetraphobia,Spike", "Wind Up Fist,Wind Up Fist,Wind Up Fist"]));  }    if (levelupselections.indexOf(x + "Void Cannon,Antimatter,Antimatter") > -1) {    Rules.substitute("Backfire", "Illuminate");     Rules.substitute("Bop,Bop,Bop", rand(["Magnet,Duplicake,Magnet", "Magnet,Lights Out,Magnet", "Duplicake,Duplicake,Duplicake"]));  }    if (levelupselections.indexOf(x + "Plasma Cannon,Thruster,Thruster") > -1) {    Rules.substitute("Backfire", "Wrecking Ball");    Rules.substitute("Bop,Bop,Bop", rand(["Reload,Meteor,Reload", "Reload,Nightmare,Reload", "Meteor,Meteor,Meteor"]));  }    if (levelupselections.indexOf(x + "Energy Drink,Accumulator,Accumulator") > -1) {    Rules.substitute("Backfire", "Shadow Dice");     Rules.substitute("Bop,Bop,Bop", rand(["Accumulator,Special Attack,Accumulator", "Accumulator,Shadow Dice,Accumulator", "Special Attack,Special Attack,Special Attack"]));  }    if (levelupselections.indexOf(x + "Armor Shard,Starfruit,Starfruit") > -1) {    Rules.substitute("Backfire", "Healing Crystal");    Rules.substitute("Bop,Bop,Bop", rand(["Spiky Armor,Gumball Machine,Spiky Armor", "Spiky Armor,Starfruit,Spiky Armor", "Gumball Machine,Gumball Machine,Gumball Machine"]));  }    if (levelupselections.indexOf(x + "Lament,Ice Shatter,Ice Shatter") > -1){     Rules.substitute("Backfire", "Ice Shatter");     Rules.substitute("Bop,Bop,Bop", rand(["Snowflake,Whip,Snowflake", "Snowflake,Hammer,Snowflake", "Snowball,Snowflake,Snowball"]));   }    if (levelupselections.indexOf(x + "Hammer,High Voltage,High Voltage") > -1){     Rules.substitute("Backfire", "High Voltage");     Rules.substitute("Bop,Bop,Bop", rand(["Buzzer,Whip,Buzzer", "Buzzer,Lament,Buzzer", "Electric Shock,Buzzer,Electric Shock"]));   }    if (levelupselections.indexOf(x + "Whip,Flame Blast,Flame Blast") > -1){     Rules.substitute("Backfire", "Flame Blast");     Rules.substitute("Bop,Bop,Bop", rand(["Spark,Lament,Spark", "Spark,Hammer,Spark", "Fireball,Spark,Fireball"]));   }    if (levelupselections.indexOf(x + "Ð ocket Knife[],Master Key,Master Key") > -1){     Rules.substitute("Backfire", "Hacksaw");     Rules.substitute("Bop,Bop,Bop", rand(["Lockpick,Hacksaw,Lockpick", "Lockpick,Duplicate,Lockpick", "Subdivide,Hacksaw,Subdivide"]));   }    if (levelupselections.indexOf(x + "Call for Backup Thief?,Pickpocket,Pickpocket") > -1){     Rules.substitute("Backfire", "Pickpocket");     Rules.substitute("Bop,Bop,Bop", "Lockpick,Call for Backup Thief?,Lockpick");  }    if (levelupselections.indexOf(x + "Poison Needle,Lockpick,Lockpick") > -1){     Rules.substitute("Backfire", "Detonator");     Rules.substitute("Bop,Bop,Bop", rand(["Poison Needle,Detonator,Poison Needle", "Spatula,Toxic Ooze,Spatula", "Subdivide,Poison Needle,Subdivide"]));  }    if (levelupselections.indexOf(x + "Six Shooter,Spatula,Spatula") > -1){     Rules.substitute("Backfire", "Ungeradedice");     Rules.substitute("Bop,Bop,Bop", rand(["Doppeldice,Bump,Doppeldice", "Wrecking Ball,Midnight Charm,Wrecking Ball", "Candy,Six Shooter,Candy"]));  }    if (levelupselections.indexOf(x + "Grater,Poison Needle,Poison Needle") > -1){     Rules.substitute("Backfire", "Grater");     Rules.substitute("Bop,Bop,Bop", rand(["Hacksaw,Detonator,Hacksaw", "Poison Jab,Detonator,Poison Jab", "Subdivide,Toxic Ooze,Subdivide"]));  }    if (levelupselections.indexOf(x + "Boolin Key,Jack o' Lantern,Jack o' Lantern") > -1){     Rules.substitute("Backfire", "Boolin Key");     Rules.substitute("Bop,Bop,Bop", rand(["Illuminate,Jack o' Lantern,Illuminate", "Spectral Strike,Boo,Spectral Strike", "Boo,Spook,Boo"]));  }    if (levelupselections.indexOf(x + "Fool's Errand,Hitodama,Hitodama") > -1){     Rules.substitute("Backfire", "Wispene Gas");     Rules.substitute("Bop,Bop,Bop", rand(["Hitodama,Exorcise,Hitodama", "Banish,Hitodama,Banish", "Poof,Banish,Poof"]));  }    if (levelupselections.indexOf(x + "Soul Fade,Attacktoplasm,Attacktoplasm") > -1){     Rules.substitute("Backfire", "Spook");     Rules.substitute("Bop,Bop,Bop", rand(["Spook,Boo,Spook", "Attacktoplasm,Spook,Attacktoplasm", "Boo,Spectral Strike,Boo"]));  }    if (levelupselections.indexOf(x + "Exorcise,Blurse,Blurse") > -1){     Rules.substitute("Backfire", "Flying Skull");     Rules.substitute("Bop,Bop,Bop", rand(["Evil Laugh,Blurse,Evil Laugh", "Flying Skull,Soul Fade,Flying Skull", "Shadow Ball,Flying Skull,Shadow Ball"]));  }    if (levelupselections.indexOf(x + "Wispene Gas,Pester,Pester") > -1){     Rules.substitute("Backfire", "Chocolate Spookie");     Rules.substitute("Bop,Bop,Bop", rand(["Treat,Pester,Treat", "Treat,Ectocookie,Treat", "Pester,Treat,Pester"]));  }    if (levelupselections.indexOf(x + "Shielded Bash,Double Guard,Double Guard") > -1){     Rules.substitute("Backfire", "Irony Shield");     Rules.substitute("Bop,Bop,Bop", rand(["Expired Sweets,Double Guard,Expired Sweets", "Expired Sweets,Shielded Bash,Double Guard", "Double Guard,Double Guard,Double Guard"]));   }     if (levelupselections.indexOf(x + "Ice Splatter,Sleet Clump,Sleet Clump") > -1){     Rules.substitute("Backfire", "Grieve");     Rules.substitute("Bop,Bop,Bop", rand(["Sleet Clump,Zapper,Sleet Clump", "Ouch,Frostbite,Ouch", "Ouch,Grieve,Ouch"]));   }    if (levelupselections.indexOf(x + "Deton'tor,Duotoxin,Duotoxin") > -1){     Rules.substitute("Backfire", "Declaw");     Rules.substitute("Bop,Bop,Bop", rand(["Duotoxin,Duotoxin,Duotoxin", "Duotoxin,Declaw,Expired Sweets", "Expired Sweets,Duotoxin,Expired Sweets"]));   }    if (levelupselections.indexOf(x + "Low Voltage,Zapper,Zapper") > -1){     Rules.substitute("Backfire", "Mallet");     Rules.substitute("Bop,Bop,Bop", rand(["Zapper,Mallet,Zapper", "Low Voltage,Flicker,Low Voltage"]));   }    if (levelupselections.indexOf(x + "Blame Blast,Flicker,Flicker") > -1){     Rules.substitute("Backfire", "Lash");     Rules.substitute("Bop,Bop,Bop", rand(["Flicker,Flicker,Flicker", "Zapper,Lash,Zapper", "Sleet Clump,Flicker, Sleet Clump"]));   }    if (levelupselections.indexOf(x + "Whyjinx,Slapstick,Slapstick") > -1){     Rules.substitute("Backfire", "Concen'tration");     Rules.substitute("Bop,Bop,Bop", rand(["Whyjinx,Cruel Mercy,Concen'tration", "Slapstick,Nojinx,Slapstick"]));   }    if (levelupselections.indexOf(x + "Falling Skull,Raspy Laugh,Raspy Laugh") > -1){     Rules.substitute("Backfire", "Raspy Laugh");     Rules.substitute("Bop,Bop,Bop", rand(["Raspy Laugh,Raspy Laugh,Raspy Laugh", "Panicked Laugh,Unfestation,Panicked Laugh"]));   }    if (levelupselections.indexOf(x + "Oof Oof Oof,Ruff Ruff Rage,Ruff Ruff Rage") > -1){     Rules.substitute("Backfire", "Yip Yip Nope");     Rules.substitute("Bop,Bop,Bop", rand(["Ruff Ruff Rage,Arf Arf Argh,Ruff Ruff Rage", "Ruff Ruff Rage,Yip Yip Nope,Ruff Ruff Rage"]));  }    if (levelupselections.indexOf(x + "Voodice,U Do Voodoo,U Do Voodoo") > -1){     Rules.substitute("Backfire", rand(["Vootwo", "Vootwo", "Voodoo Pin", "Voodoo Pin", "Voodice", "Accursed Needle"]));    var smallcard = rand(["U Do Voodoo", "Acupuncture", "U Do Voodoo", "Acupuncture", "U Do Voodoo", "Acupuncture", "Ominous Chant", "Hexed Needle", "Soul Sap"]);    var bigcard = rand(["Pressure Point", "Spirit Prayer", "Pressure Point", "Spirit Prayer", "Voodice", "Voodoo Pin"]);    var pack = rand([smallcard + "," + bigcard + "," + smallcard, smallcard + "," + bigcard + "," + smallcard, smallcard + "," + smallcard + "," + smallcard]);    Rules.substitute("Bop,Bop,Bop", pack);  }    if (levelupselections.indexOf(x + "Voodoom,Hexed Needle,Hexed Needle") > -1){     Rules.substitute("Backfire", rand(["Vootwo", "Vootwo", "Voodoo Pin", "Voodoom", "Accursed Needle", "Accursed Needle"]));    var smallcard = rand(["Hexed Needle", "Soul Sap", "Hexed Needle", "Soul Sap", "Hexed Needle", "Soul Sap", "Ominous Chant", "U Do Voodoo", "Acupuncture"]);    var bigcard = rand(["Pressure Point", "Ritual Sacrifice", "Pressure Point", "Ritual Sacrifice", "Voodoom", "Accursed Needle"]);    var pack = rand([smallcard + "," + bigcard + "," + smallcard, smallcard + "," + bigcard + "," + smallcard, smallcard + "," + smallcard + "," + smallcard]);    Rules.substitute("Bop,Bop,Bop", pack);  }    if (levelupselections.indexOf(x + "Foggy Glass,Poof,Poof") > -1){    Rules.substitute("Backfire", rand(["Sceptre", "Scientology Pamphlet"]));    Rules.substitute("Bop,Bop,Bop", rand(["Shudder,Poof,Shudder","Zoop Zoop,Gaslighting,Zoop Zoop","Poof,Banish,Poof","Zoop Zoop,Swamp Gas,Zoop Zoop"]));  }  if (levelupselections.indexOf(x + "Lucky Charm,Reckless Flailing,Reckless Flailing") > -1){    Rules.substitute("Backfire", rand(["Fissure","Sheer Cold","Guillotine","Healer Staff"]));    Rules.substitute("Bop,Bop,Bop", rand(["Beginner's Luck,Lucky Charm,Reckless Flailing","Trinity Charm,Zoop Zoop,Trinity Charm","Delicious Fruit,Bop Bop,Delicious Fruit"]));  }  if (levelupselections.indexOf(x + "Spite,Folly,Folly") > -1){    Rules.substitute("Backfire", rand(["Distort", "Respite"]));    Rules.substitute("Bop,Bop,Bop", rand(["Stumble,Boomerang,Stumble","Super Backfire,Respite,Super Backfire"]));  }  if (levelupselections.indexOf(x + "Wind Chimes,Cyclone,Cyclone") > -1){    Rules.substitute("Backfire", rand(["Turbine", "One Way Mirror"]));    Rules.substitute("Bop,Bop,Bop", "Bop Bop,Blow,Bop Bop");  }  if (levelupselections.indexOf(x + "Fastball,Hall of Mirrors[],Hall of Mirrors[]") > -1){    Rules.substitute("Backfire", rand(["Retroreflector", "Broken Mirror"]));    Rules.substitute("Bop,Bop,Bop", rand(["Cauldron,Mirror Cauldron,Cauldron","Bop Bop,Mirror Shard,Bop Bop"]));  }  if (levelupselections.indexOf(x + "Speak Softly,Ivy,Ivy") > -1){    Rules.substitute("Backfire", rand(["Big Stick", "Dark Hedges"]));    Rules.substitute("Bop,Bop,Bop", rand(["Flower Pot,Magic Thistle,Flower Pot","Bop Bop,Cactus Spear,Bop Bop"]));  }  if (levelupselections.indexOf(x + "Chip Socket,IC Chip,IC Chip") > -1){    Rules.substitutions.set("replacewithchips","yep");    Rules.substitute("Backfire", rand(["Toggle Chip", "Time Lapse"]));    Rules.substitute("Bop,Bop,Bop", "Zoop Zoop,Chipmine,Zoop Zoop","Bop Bop,Mystical Chip,Bop Bop");  }  if (levelupselections.indexOf(x + "Sticky Cauldron,Crazy Glue,Crazy Glue") > -1){    Rules.substitute("Backfire", "Counter Spell");    Rules.substitute("Bop,Bop,Bop", rand(["Bop Bop,Parrying Dagger,Bop Bop","Hurricane,Zoop Zoop,Hurricane"]));  }
  for(y in loadtext("diceydungeons/jesterpacks/packs_cvall")){
	if(levelupselections.indexOf(x + y) > -1){
	  Rules.substitute("Backfire", "Mercy");
	  Rules.substitute("Bop,Bop,Bop","Lojinx,Lojinx,Lojinx");
	}
  }
}